import pandas as pd


df = pd.read_csv('data/train.csv')

'''
–ó–∞–≥—Ä—É–∑–∏ CSV-—Ñ–∞–π–ª –≤ pandas –∏ –≤—ã–≤–µ–¥–∏:
–ø–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
–æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤
—Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ –∫–∞–∂–¥–æ–º—É —Å—Ç–æ–ª–±—Ü

print(df.head())
print(df.describe())
print(df.info())


#üîπ –ó–∞–¥–∞–Ω–∏–µ:
# –ù–∞–π–¥–∏:
# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –∫–∞–∂–¥–æ–º —Å—Ç–æ–ª–±—Ü–µ.
# –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –æ–¥–Ω–æ–º –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤.
# –°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∏–∑ —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

print(df.isnull().sum()) #–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–µ
print(df['Name'].value_counts())
print(df['Age'].mean())

#üîπ –ó–∞–¥–∞–Ω–∏–µ: –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –æ –ø–∞—Å—Å–∞–∂–∏—Ä–∞—Ö
# –£ —Ç–µ–±—è –µ—Å—Ç—å DataFrame df, –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —ç—Ç–æ Titanic (train.csv). –í—ã–ø–æ–ª–Ω–∏ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
# 1. –°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –º—É–∂—á–∏–Ω –∏ –∂–µ–Ω—â–∏–Ω –±—ã–ª–æ –Ω–∞ –±–æ—Ä—Ç—É?–ü–æ–¥—Å—á–∏—Ç–∞–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤ –ø–æ –ø–æ–ª—É (Sex).
# 2. –ö–∞–∫–æ–≤–∞ –≤—ã–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –ø–æ –ø–æ–ª—É?
# –í—ã—á–∏—Å–ª–∏ –¥–æ–ª—é –≤—ã–∂–∏–≤—à–∏—Ö (Survived) –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã –º—É–∂—á–∏–Ω –∏ –∂–µ–Ω—â–∏–Ω.
# 3. –ö–∞–∫–∞—è —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –±–∏–ª–µ—Ç–∞ (Fare) —É –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤ –ø–æ –∫–ª–∞—Å—Å–∞–º (Pclass)?
# –ü–æ—Å—á–∏—Ç–∞–π —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ Fare –ø–æ –∫–∞–∂–¥–æ–º—É –∫–ª–∞—Å—Å—É.
# 4. –ö—Ç–æ –ø–ª–∞—Ç–∏–ª —Å–∞–º—ã–π –¥–æ—Ä–æ–≥–æ–π –±–∏–ª–µ—Ç?
# –ù–∞–π–¥–∏ –∏–º—è –ø–∞—Å—Å–∞–∂–∏—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø–ª–∞—Ç–∏–ª –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å—É–º–º—É.

print(f'{df['Sex'].value_counts()}, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤') #–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤
# –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ–ª—É –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π –¥–æ–ª–∏ –≤—ã–∂–∏–≤—à–∏—Ö
print(df.groupby('Sex')['Survived'].mean())
print(df.groupby('Pclass')['Fare'].mean())

max_fare = df['Fare'].max()
print(df[df['Fare'] == max_fare][['Name', 'Fare']])



#üîß –ó–∞–¥–∞–Ω–∏–µ 1: –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
# –ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ —Å—Ç–æ–ª–±–µ—Ü Age, –≤ –Ω—ë–º —á–∞—Å—Ç–æ –±—ã–≤–∞—é—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.
# –¢–≤–æ—è –∑–∞–¥–∞—á–∞:
# –ü–æ—Å—á–∏—Ç–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–ø—É—â–µ–Ω–æ.
# –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–∏–º –≤–æ–∑—Ä–∞—Å—Ç–æ–º.
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –±–æ–ª—å—à–µ –Ω–µ—Ç.

print(df['Age'].isnull().sum())  # –ü–æ—Å—á–∏—Ç–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–ø—É—â–µ–Ω–æ
df['Age'] = df['Age'].fillna(df['Age'].mean())  # –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏ —Å—Ä–µ–¥–Ω–∏–º
print(df['Age'].isnull().sum())  # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –±–æ–ª—å—à–µ –Ω–µ—Ç


#üîß –ó–∞–¥–∞–Ω–∏–µ 2: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞
# –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü FamilySize, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å—É–º–º—É SibSp
# (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—Ä–∞—Ç—å–µ–≤/—Å–µ—Å—Ç—ë—Ä/—Å—É–ø—Ä—É–≥–æ–≤) –∏ Parch (—Ä–æ–¥–∏—Ç–µ–ª–∏/–¥–µ—Ç–∏) –ø–ª—é—Å 1 (—Å–∞–º –ø–∞—Å—Å–∞–∂–∏—Ä).
# –ü—Ä–∏–º–µ—Ä: –µ—Å–ª–∏ SibSp = 1, Parch = 2, —Ç–æ FamilySize = 4.

df['FamilySize'] = df['SibSp'] + df['Parch'] + 1


#üîß –ó–∞–¥–∞–Ω–∏–µ 3 (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, –Ω–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ):
# –ü—Ä–æ–≤–µ—Ä—å, –∫–∞–∫ FamilySize –≤–ª–∏—è–µ—Ç –Ω–∞ –≤—ã–∂–∏–≤–∞–µ–º–æ—Å—Ç—å:
# –°–≥—Ä—É–ø–ø–∏—Ä—É–π –ø–æ FamilySize
# –ü–æ—Å—á–∏—Ç–∞–π –¥–æ–ª—é –≤—ã–∂–∏–≤—à–∏—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
print(df.groupby('FamilySize')['Survived'].mean())

#–ó–∞–¥–∞–Ω–∏–µ 4: –†–∞–±–æ—Ç–∞ —Å–æ —Å—Ç–æ–ª–±—Ü–∞–º–∏ —Å —Ç–µ–∫—Å—Ç–æ–º –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
# –ü–æ—Å–º–æ—Ç—Ä–∏, –∫–∞–∫–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –µ—Å—Ç—å –≤ —Å—Ç–æ–ª–±—Ü–µ 'Embarked' (–ø–æ—Ä—Ç –ø–æ—Å–∞–¥–∫–∏).
# –ü–æ—Å—á–∏—Ç–∞–π, —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ 'Embarked'.
# –ó–∞–ø–æ–ª–Ω–∏ –ø—Ä–æ–ø—É—Å–∫–∏ —Å–∞–º—ã–º —á–∞—Å—Ç—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º (–º–æ–¥–æ–π).
# –í—ã–≤–µ–¥–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤, –ø—Ä–∏—à–µ–¥—à–∏—Ö —Å –∫–∞–∂–¥–æ–≥–æ –ø–æ—Ä—Ç–∞.

print(df['Embarked'].value_counts())
print(df['Embarked'].isnull().sum())
df['Embarked'] = df['Embarked'].fillna(df['Embarked'].mode()[0])


#–ó–∞–¥–∞–Ω–∏–µ 5: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É
# –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü 'AgeGroup', –≤ –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ø–∞–¥—É—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É:
# 'Child' ‚Äî –µ—Å–ª–∏ –≤–æ–∑—Ä–∞—Å—Ç –º–µ–Ω—å—à–µ 18,
# 'Adult' ‚Äî –æ—Ç 18 –¥–æ 60,
# 'Senior' ‚Äî —Å—Ç–∞—Ä—à–µ 60.
# –ü–æ—Å–º–æ—Ç—Ä–∏, –∫–∞–∫ –º–µ–Ω—è–µ—Ç—Å—è –≤—ã–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–π –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã (—Å–≥—Ä—É–ø–ø–∏—Ä—É–π –∏ –ø–æ—Å—á–∏—Ç–∞–π —Å—Ä–µ–¥–Ω–µ–µ Survived).

df['AgeGroup'] = df['Age'].apply(lambda x: 'Child' if x < 18 else ('Adult' if x < 60 else 'Senior'))
print(df.groupby('AgeGroup')['Survived'].mean())

# –°—Ä–µ–¥–Ω—è—è –≤—ã–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –≥—Ä—É–ø–ø–µ
age_group_survival = df.groupby('AgeGroup')['Survived'].mean().reset_index()

# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
sns.barplot(data=age_group_survival, x='AgeGroup', y='Survived')
plt.title('–î–æ–ª—è –≤—ã–∂–∏–≤—à–∏—Ö –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –≥—Ä—É–ø–ø–∞–º')
plt.ylabel('–î–æ–ª—è –≤—ã–∂–∏–≤—à–∏—Ö')
plt.xlabel('–í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞')
plt.ylim(0, 1)
plt.grid(axis='y', linestyle='--', alpha=0.7)
plt.show()


#üî∏ –ó–∞–¥–∞–Ω–∏–µ 6: –†–∞–±–æ—Ç–∞ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
# –ü—Ä–µ–æ–±—Ä–∞–∑—É–π —Å—Ç–æ–ª–±—Ü—ã Sex –∏ Embarked –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ —Ç–∏–ø—ã —Å –ø–æ–º–æ—â—å—é .astype('category').
# –£–∑–Ω–∞–π, —Å–∫–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –Ω–∏—Ö.
# –°–¥–µ–ª–∞–π One-Hot –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —ç—Ç–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ —Å –ø–æ–º–æ—â—å—é pd.get_dummies().
# –°—Ä–∞–≤–Ω–∏ —Ä–∞–∑–º–µ—Ä –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ –∏ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ –ø–æ—Å–ª–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è (–∫–æ–ª-–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ –ø–∞–º—è—Ç–∏).


cat_per = ['Sex', 'Embarked']
onehot_df = pd.get_dummies(df, columns=cat_per, dummy_na=False)
print(onehot_df.head())
print(f'–ò—Å—Ö–æ–¥–Ω–æ–µ —á–∏—Å–ª–æ —Å—Ç–æ–ª–±—Ü–æ–≤: {df.shape[1]}')
print(f'–ü–æ—Å–ª–µ one-hot –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è: {onehot_df.shape[1]}')
print(f'–ü–∞–º—è—Ç—å –¥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è: {df.memory_usage(deep=True).sum() / 1024:.2f} KB')
print(f'–ü–∞–º—è—Ç—å –ø–æ—Å–ª–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è: {onehot_df.memory_usage(deep=True).sum() / 1024:.2f} KB')


#üî∏ –ó–∞–¥–∞–Ω–∏–µ 7: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —É—Å–ª–æ–≤–∏—è–º
# –ù–∞–ø—Ä–∏–º–µ—Ä:
# –ù–∞–π–¥–∏ –≤—Å–µ—Ö –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ:
# –ñ–µ–Ω—â–∏–Ω—ã (Sex == 'female'),
# –°—Ç–∞—Ä—à–µ 30 –ª–µ—Ç,
# –ò –ø—Ä–∏ —ç—Ç–æ–º –ø—É—Ç–µ—à–µ—Å—Ç–≤–æ–≤–∞–ª–∏ –≤ –ø–µ—Ä–≤–æ–º –∫–ª–∞—Å—Å–µ (Pclass == 1).
# –í—ã–≤–µ–¥–∏ –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ –ø–µ—Ä–≤—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫.

filtred_df = df[(df['Sex'] == 'female') & (df['Age'] > 30) & (df['Pclass'] == 1)]'''


